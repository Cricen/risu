#!/usr/bin/env ruby

require 'rubygems'
require 'irb'

prompt = 
'
                                   _ _       
 _ __   ___  ___ ___ _   _ ___  __| | |__  
| \'_ \ / _ \/ __/ __| | | / __|/ _` | \'_ \ 
| | | |  __/\__ \__ \ |_| \__ \ (_| | |_) |
|_| |_|\___||___/___/\__,_|___/\__,_|_.__/ 

'

def consolize &block
  
  yield

	IRB.setup(nil)
	IRB.conf[:USE_READLINE] = true
	IRB.conf[:PROMPT_MODE] = :SIMPLE
	
	irb = IRB::Irb.new
	IRB.conf[:MAIN_CONTEXT] = irb.context
	
		
  irb.context.evaluate("require 'irb/completion'", 0)

  trap("SIGINT") do
    irb.signal_handle
  end
  catch(:IRB_EXIT) do
    irb.eval_input
  end
end

consolize do
  $LOAD_PATH.unshift(File.join(File.dirname(__FILE__), '../lib'))
	require 'nessusdb'
	app = NessusDB::CLI::Application.new
	app.load_config
	app.db_connect
	puts prompt
	puts "NessusDB Console"
end
